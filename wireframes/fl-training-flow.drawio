<mxfile host="65bd71144e" modified="2026-02-07" agent="Copilot" etag="fl-flow-v1" version="21.6.8" type="device">
    <diagram id="fl-flow" name="FL Training Flow with CKKS HE">
        <mxGraphModel dx="2074" dy="1156" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1200" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>

                <!-- Background -->
                <mxCell id="bg" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=none;" vertex="1" parent="1">
                    <mxGeometry x="0" y="0" width="1920" height="1200" as="geometry"/>
                </mxCell>

                <!-- Title -->
                <mxCell id="title" value="Federated Learning Training Flow with CKKS Homomorphic Encryption" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=24;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="360" y="20" width="1200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="subtitle" value="Flower Framework | FedAvg | TenSEAL CKKS | 3 Clients (Bank A/B/C) | 25 Rounds | CNN-LSTM IDS Model" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=13;fontColor=#64748B;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="360" y="56" width="1200" height="22" as="geometry"/>
                </mxCell>

                <!-- =========================================================== -->
                <!-- ROUND LIFECYCLE (horizontal flow across top)                -->
                <!-- =========================================================== -->
                <mxCell id="roundFlow" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#334155;strokeWidth=1;dashed=1;dashPattern=6 4;arcSize=3;" vertex="1" parent="1">
                    <mxGeometry x="40" y="100" width="1840" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="roundLabel" value="ROUND LIFECYCLE (repeated N times, default 25)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontColor=#475569;fontFamily=Inter;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="60" y="106" width="400" height="18" as="geometry"/>
                </mxCell>

                <mxCell id="step1" value="1. Server distributes global model" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A855F7;strokeColor=none;fontColor=#FFFFFF;fontSize=11;fontFamily=Inter;fontStyle=1;arcSize=15;" vertex="1" parent="1">
                    <mxGeometry x="60" y="134" width="240" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="stepArr1" value="" style="endArrow=classic;html=1;strokeColor=#475569;strokeWidth=1;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="300" y="150" as="sourcePoint"/>
                        <mxPoint x="320" y="150" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="step2" value="2. Clients train on local data" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6366F1;strokeColor=none;fontColor=#FFFFFF;fontSize=11;fontFamily=Inter;fontStyle=1;arcSize=15;" vertex="1" parent="1">
                    <mxGeometry x="320" y="134" width="220" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="stepArr2" value="" style="endArrow=classic;html=1;strokeColor=#475569;strokeWidth=1;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="540" y="150" as="sourcePoint"/>
                        <mxPoint x="560" y="150" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="step3" value="3. CKKS encrypt LSTM+FC updates" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF4444;strokeColor=none;fontColor=#FFFFFF;fontSize=11;fontFamily=Inter;fontStyle=1;arcSize=15;" vertex="1" parent="1">
                    <mxGeometry x="560" y="134" width="250" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="stepArr3" value="" style="endArrow=classic;html=1;strokeColor=#475569;strokeWidth=1;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="810" y="150" as="sourcePoint"/>
                        <mxPoint x="830" y="150" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="step4" value="4. Send via gRPC to server" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#22C55E;strokeColor=none;fontColor=#FFFFFF;fontSize=11;fontFamily=Inter;fontStyle=1;arcSize=15;" vertex="1" parent="1">
                    <mxGeometry x="830" y="134" width="200" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="stepArr4" value="" style="endArrow=classic;html=1;strokeColor=#475569;strokeWidth=1;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1030" y="150" as="sourcePoint"/>
                        <mxPoint x="1050" y="150" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="step5" value="5. Server decrypts + FedAvg" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F59E0B;strokeColor=none;fontColor=#0F172A;fontSize=11;fontFamily=Inter;fontStyle=1;arcSize=15;" vertex="1" parent="1">
                    <mxGeometry x="1050" y="134" width="220" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="stepArr5" value="" style="endArrow=classic;html=1;strokeColor=#475569;strokeWidth=1;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1270" y="150" as="sourcePoint"/>
                        <mxPoint x="1290" y="150" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="step6" value="6. Update global model" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A855F7;strokeColor=none;fontColor=#FFFFFF;fontSize=11;fontFamily=Inter;fontStyle=1;arcSize=15;" vertex="1" parent="1">
                    <mxGeometry x="1290" y="134" width="180" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="stepArr6" value="" style="endArrow=classic;html=1;strokeColor=#475569;strokeWidth=1;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1470" y="150" as="sourcePoint"/>
                        <mxPoint x="1490" y="150" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="step7" value="7. Save checkpoint + metrics" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#3B82F6;strokeColor=none;fontColor=#FFFFFF;fontSize=11;fontFamily=Inter;fontStyle=1;arcSize=15;" vertex="1" parent="1">
                    <mxGeometry x="1490" y="134" width="220" height="32" as="geometry"/>
                </mxCell>
                <mxCell id="stepLoop" value="repeat" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#475569;fontFamily=Inter;fontStyle=3;" vertex="1" parent="1">
                    <mxGeometry x="1730" y="142" width="50" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="stepLoopArr" value="" style="endArrow=classic;html=1;strokeColor=#475569;strokeWidth=1;curved=1;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="1770" y="140" as="sourcePoint"/>
                        <mxPoint x="1800" y="110" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1840" y="120"/>
                            <mxPoint x="1840" y="100"/>
                        </Array>
                    </mxGeometry>
                </mxCell>

                <!-- =========================================================== -->
                <!-- FL SERVER (Center)                                          -->
                <!-- =========================================================== -->
                <mxCell id="server" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1E293B;strokeColor=#A855F7;strokeWidth=3;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="620" y="220" width="680" height="400" as="geometry"/>
                </mxCell>
                <mxCell id="serverTitle" value="Flower FL Server (fl_server:8080)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=20;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="640" y="230" width="400" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="serverPort" value="gRPC :8080" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#A855F7;fontFamily=JetBrains Mono;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="1160" y="230" width="120" height="24" as="geometry"/>
                </mxCell>

                <!-- FedAvg Strategy -->
                <mxCell id="fedavg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#A855F7;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="640" y="280" width="300" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="fedavgTitle" value="FedAvg Aggregation Strategy" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=14;fontColor=#A855F7;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="290" width="260" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="fedavgFormula" value="w_global = SUM(n_k / n) * w_k" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#F8FAFC;fontFamily=JetBrains Mono;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="660" y="320" width="260" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="fedavgDesc" value="Weighted average of client model updates,&#xa;proportional to each client's sample count." style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#64748B;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="346" width="260" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="fedavgStep1" value="1. Wait for all 3 clients" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="386" width="200" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="fedavgStep2" value="2. Decrypt CKKS ciphertexts" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#EF4444;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="406" width="200" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="fedavgStep3" value="3. Compute weighted average" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="426" width="200" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="fedavgStep4" value="4. Update global state_dict" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="446" width="200" height="16" as="geometry"/>
                </mxCell>

                <!-- CKKS Decryption Module -->
                <mxCell id="ckksDecrypt" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#EF4444;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="960" y="280" width="320" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="ckksDecTitle" value="CKKS Decryption (Server-side)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=14;fontColor=#EF4444;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="980" y="290" width="280" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="ckksDecLib" value="Library: TenSEAL" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontColor=#F8FAFC;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="980" y="320" width="180" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="ckksDecParam1" value="poly_modulus_degree: 16384" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="980" y="346" width="260" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="ckksDecParam2" value="coeff_mod_bit_sizes: [60,40,40,40,40,60]" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="980" y="366" width="300" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="ckksDecParam3" value="global_scale: 2^40" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="980" y="386" width="180" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="ckksDecFlow" value="secret_key.decrypt(encrypted_update)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#EF4444;fontFamily=JetBrains Mono;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="980" y="416" width="280" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="ckksDecNote" value="Decrypts LSTM + FC layer weights only" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#64748B;fontFamily=Inter;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="980" y="440" width="260" height="14" as="geometry"/>
                </mxCell>

                <!-- Global Model -->
                <mxCell id="globalModel" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#22C55E;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="640" y="500" width="320" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="globalModelTitle" value="Global CNN-LSTM Model" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=14;fontColor=#22C55E;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="510" width="260" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="globalModelArch" value="Conv1d(78,64) -> LSTM(64,64) -> Linear(64,1) -> Sigmoid" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="660" y="538" width="280" height="14" as="geometry"/>
                </mxCell>
                <mxCell id="globalModelFile" value="cnn_lstm_global_with_HE_25rounds_16k.pt" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#6366F1;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="660" y="558" width="280" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="globalModelInput" value="Input: (batch, 10, 78) | Output: score [0,1]" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#64748B;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="660" y="578" width="260" height="14" as="geometry"/>
                </mxCell>

                <!-- Metrics Storage -->
                <mxCell id="metricsBox" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#3B82F6;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="980" y="500" width="300" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="metricsTitle" value="Round Metrics (PostgreSQL)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=14;fontColor=#3B82F6;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1000" y="510" width="260" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="metricsItems" value="fl_rounds: loss, accuracy, F1, precision, recall&#xa;fl_client_metrics: per-client loss, accuracy, time&#xa;model_checkpoint_path: saved .pt file" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1000" y="540" width="260" height="46" as="geometry"/>
                </mxCell>

                <!-- =========================================================== -->
                <!-- CLIENT A (Left)                                             -->
                <!-- =========================================================== -->
                <mxCell id="clientA" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1E293B;strokeColor=#6366F1;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="40" y="660" width="560" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="clientATitle" value="FL Client A  -  Bank_A" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="60" y="670" width="300" height="28" as="geometry"/>
                </mxCell>
                <mxCell id="clientABadge" value="fl_client_a" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#6366F1;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="480" y="674" width="100" height="18" as="geometry"/>
                </mxCell>

                <!-- Local Dataset -->
                <mxCell id="cAData" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="60" y="710" width="240" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="cADataTitle" value="Local Dataset (IID Partition)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="80" y="718" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="cADataInfo" value="CIC-IDS2017 subset&#xa;78 features, 7 attack types&#xa;~33% of total dataset" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="80" y="742" width="200" height="42" as="geometry"/>
                </mxCell>

                <!-- Local Trainer -->
                <mxCell id="cATrain" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#6366F1;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="320" y="710" width="260" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="cATrainTitle" value="Local CNN-LSTM Training" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#6366F1;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="340" y="718" width="220" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="cATrainInfo" value="BCEWithLogitsLoss(pos_weight=5.0)&#xa;Adam optimizer, lr=1e-3&#xa;Sliding window: len=10, stride=5" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="340" y="742" width="230" height="42" as="geometry"/>
                </mxCell>

                <!-- Arrow: Data -> Trainer -->
                <mxCell id="cAArr1" value="" style="endArrow=classic;html=1;strokeColor=#6366F1;strokeWidth=2;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="300" y="755" as="sourcePoint"/>
                        <mxPoint x="320" y="755" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>

                <!-- CKKS Encryption -->
                <mxCell id="cAEnc" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#EF4444;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="60" y="820" width="260" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="cAEncTitle" value="CKKS Encryption" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#EF4444;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="80" y="828" width="160" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="cAEncInfo1" value="Encrypt LSTM layer weights" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="80" y="852" width="200" height="14" as="geometry"/>
                </mxCell>
                <mxCell id="cAEncInfo2" value="Encrypt FC layer weights" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="80" y="870" width="200" height="14" as="geometry"/>
                </mxCell>
                <mxCell id="cAEncInfo3" value="Conv1d layer sent in plaintext" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#F59E0B;fontFamily=Inter;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="80" y="888" width="200" height="14" as="geometry"/>
                </mxCell>
                <mxCell id="cAEncTool" value="TenSEAL CKKSVector" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#EF4444;fontFamily=JetBrains Mono;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="80" y="910" width="180" height="14" as="geometry"/>
                </mxCell>

                <!-- gRPC Send -->
                <mxCell id="cASend" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#22C55E;strokeColor=none;arcSize=10;opacity=80;" vertex="1" parent="1">
                    <mxGeometry x="340" y="830" width="240" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="cASendTitle" value="gRPC Send to Server" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FFFFFF;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="360" y="840" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="cASendInfo" value="Serialized update payload:&#xa;- Encrypted LSTM weights (bytes)&#xa;- Encrypted FC weights (bytes)&#xa;- Plaintext Conv1d weights&#xa;- num_samples, metrics" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#FFFFFF;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="360" y="866" width="200" height="56" as="geometry"/>
                </mxCell>

                <!-- Arrow: Trainer -> Encrypt -->
                <mxCell id="cAArr2" value="" style="endArrow=classic;html=1;strokeColor=#EF4444;strokeWidth=2;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="420" y="800" as="sourcePoint"/>
                        <mxPoint x="190" y="820" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="420" y="812"/>
                            <mxPoint x="190" y="812"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="cAArr2Label" value="model updates" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;fontColor=#EF4444;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="260" y="804" width="80" height="12" as="geometry"/>
                </mxCell>

                <!-- Arrow: Encrypt -> Send -->
                <mxCell id="cAArr3" value="" style="endArrow=classic;html=1;strokeColor=#22C55E;strokeWidth=2;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="320" y="880" as="sourcePoint"/>
                        <mxPoint x="340" y="880" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>

                <!-- =========================================================== -->
                <!-- CLIENT B (Center Bottom)                                    -->
                <!-- =========================================================== -->
                <mxCell id="clientB" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1E293B;strokeColor=#6366F1;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="680" y="660" width="560" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="clientBTitle" value="FL Client B  -  Bank_B" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="700" y="670" width="300" height="28" as="geometry"/>
                </mxCell>
                <mxCell id="clientBBadge" value="fl_client_b" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#6366F1;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="1120" y="674" width="100" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="cBPipeline" value="Local Data (IID ~33%) -> CNN-LSTM Train -> CKKS Encrypt LSTM+FC -> gRPC Send" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="700" y="710" width="520" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="cBMeta1" value="Same architecture, same HE params, independent local data" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#64748B;fontFamily=Inter;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="700" y="738" width="380" height="14" as="geometry"/>
                </mxCell>
                <mxCell id="cBComp1" value="Flower Client" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="700" y="766" width="100" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cBComp2" value="CNN-LSTM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="810" y="766" width="90" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cBComp3" value="CKKS Encrypt" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#EF4444;fontColor=#EF4444;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="910" y="766" width="100" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cBComp4" value="TenSEAL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="1020" y="766" width="80" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cBComp5" value="PyTorch" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="1110" y="766" width="80" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cBDataVol" value="vol: ./data/clients/bank_b" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#6366F1;fontFamily=JetBrains Mono;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="700" y="802" width="240" height="14" as="geometry"/>
                </mxCell>

                <!-- =========================================================== -->
                <!-- CLIENT C (Right Bottom)                                     -->
                <!-- =========================================================== -->
                <mxCell id="clientC" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1E293B;strokeColor=#6366F1;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="680" y="880" width="560" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="clientCTitle" value="FL Client C  -  Bank_C" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="700" y="890" width="300" height="28" as="geometry"/>
                </mxCell>
                <mxCell id="clientCBadge" value="fl_client_c" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#6366F1;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="1120" y="894" width="100" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="cCPipeline" value="Local Data (IID ~33%) -> CNN-LSTM Train -> CKKS Encrypt LSTM+FC -> gRPC Send" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="700" y="930" width="520" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="cCMeta1" value="Same architecture, same HE params, independent local data" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#64748B;fontFamily=Inter;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="700" y="958" width="380" height="14" as="geometry"/>
                </mxCell>
                <mxCell id="cCComp1" value="Flower Client" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="700" y="986" width="100" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cCComp2" value="CNN-LSTM" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="810" y="986" width="90" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cCComp3" value="CKKS Encrypt" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#EF4444;fontColor=#EF4444;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="910" y="986" width="100" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cCComp4" value="TenSEAL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="1020" y="986" width="80" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cCComp5" value="PyTorch" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="1110" y="986" width="80" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="cCDataVol" value="vol: ./data/clients/bank_c" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#6366F1;fontFamily=JetBrains Mono;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="700" y="1022" width="240" height="14" as="geometry"/>
                </mxCell>

                <!-- =========================================================== -->
                <!-- CONNECTION ARROWS (Server <-> Clients)                      -->
                <!-- =========================================================== -->

                <!-- Server -> Client A (distribute) -->
                <mxCell id="arrSA_down" value="" style="endArrow=classic;html=1;strokeColor=#A855F7;strokeWidth=3;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="640" y="600" as="sourcePoint"/>
                        <mxPoint x="320" y="660" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="320" y="640"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrSA_downLabel" value="distribute global model" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#A855F7;fontFamily=Inter;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="360" y="630" width="140" height="14" as="geometry"/>
                </mxCell>

                <!-- Client A -> Server (send update) -->
                <mxCell id="arrAS_up" value="" style="endArrow=classic;html=1;strokeColor=#22C55E;strokeWidth=3;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="530" y="830" as="sourcePoint"/>
                        <mxPoint x="620" y="400" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="610" y="830"/>
                            <mxPoint x="610" y="400"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrAS_upLabel" value="encrypted update" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#22C55E;fontFamily=Inter;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="550" y="610" width="110" height="14" as="geometry"/>
                </mxCell>

                <!-- Server -> Client B -->
                <mxCell id="arrSB" value="" style="endArrow=classic;startArrow=classic;html=1;strokeColor=#A855F7;strokeWidth=2;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="960" y="600" as="sourcePoint"/>
                        <mxPoint x="960" y="660" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrSBLabel" value="gRPC" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#A855F7;fontFamily=Inter;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="966" y="622" width="40" height="14" as="geometry"/>
                </mxCell>

                <!-- Server -> Client C -->
                <mxCell id="arrSC" value="" style="endArrow=classic;startArrow=classic;html=1;strokeColor=#A855F7;strokeWidth=2;" edge="1" parent="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="960" y="840" as="sourcePoint"/>
                        <mxPoint x="960" y="880" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrSCLabel" value="gRPC" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#A855F7;fontFamily=Inter;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="966" y="852" width="40" height="14" as="geometry"/>
                </mxCell>

                <!-- =========================================================== -->
                <!-- HE KEY MANAGEMENT (Right Side)                              -->
                <!-- =========================================================== -->
                <mxCell id="keyMgmt" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1E293B;strokeColor=#EF4444;strokeWidth=2;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="1360" y="220" width="520" height="360" as="geometry"/>
                </mxCell>
                <mxCell id="keyTitle" value="CKKS Key Management" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=18;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1380" y="230" width="300" height="28" as="geometry"/>
                </mxCell>

                <!-- TenSEAL Context -->
                <mxCell id="tsCtx" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="1380" y="272" width="480" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="tsCtxTitle" value="TenSEAL Context (shared)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=13;fontColor=#EF4444;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="280" width="220" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="tsParam1" value="scheme = CKKS" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#F8FAFC;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="310" width="200" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="tsParam2" value="poly_modulus_degree = 16384" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="330" width="260" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="tsParam3" value="coeff_mod_bit_sizes = [60, 40, 40, 40, 40, 60]" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="350" width="380" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="tsParam4" value="global_scale = 2^40" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=JetBrains Mono;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="370" width="200" height="16" as="geometry"/>
                </mxCell>
                <mxCell id="tsParam5" value="Noise budget: ~120 bits (sufficient for FedAvg)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#64748B;fontFamily=Inter;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="392" width="300" height="14" as="geometry"/>
                </mxCell>

                <!-- Key Distribution -->
                <mxCell id="keyPub" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#22C55E;strokeColor=none;arcSize=10;opacity=70;" vertex="1" parent="1">
                    <mxGeometry x="1380" y="430" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="keyPubTitle" value="Public Key" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FFFFFF;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="438" width="100" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="keyPubInfo" value="Distributed to all 3 clients&#xa;Used for encryption" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#FFFFFF;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="458" width="180" height="26" as="geometry"/>
                </mxCell>

                <mxCell id="keySec" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF4444;strokeColor=none;arcSize=10;opacity=70;" vertex="1" parent="1">
                    <mxGeometry x="1620" y="430" width="240" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="keySecTitle" value="Secret Key" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FFFFFF;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1640" y="438" width="100" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="keySecInfo" value="Held ONLY by FL Server&#xa;Used for decryption" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#FFFFFF;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1640" y="458" width="180" height="26" as="geometry"/>
                </mxCell>

                <!-- What gets encrypted -->
                <mxCell id="encScope" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="1380" y="510" width="480" height="56" as="geometry"/>
                </mxCell>
                <mxCell id="encScopeTitle" value="Encrypted Layers:" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontColor=#F8FAFC;fontFamily=Inter;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="516" width="140" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="encLSTM" value="LSTM weights + bias" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF4444;strokeColor=none;fontColor=#FFFFFF;fontSize=10;fontFamily=Inter;arcSize=20;opacity=80;" vertex="1" parent="1">
                    <mxGeometry x="1400" y="538" width="140" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="encFC" value="FC weights + bias" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EF4444;strokeColor=none;fontColor=#FFFFFF;fontSize=10;fontFamily=Inter;arcSize=20;opacity=80;" vertex="1" parent="1">
                    <mxGeometry x="1550" y="538" width="120" height="22" as="geometry"/>
                </mxCell>
                <mxCell id="encConv" value="Conv1d (plaintext)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#334155;strokeColor=none;fontColor=#94A3B8;fontSize=10;fontFamily=Inter;arcSize=20;" vertex="1" parent="1">
                    <mxGeometry x="1680" y="538" width="120" height="22" as="geometry"/>
                </mxCell>

                <!-- =========================================================== -->
                <!-- LEGEND                                                      -->
                <!-- =========================================================== -->
                <mxCell id="legendBox" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1E293B;strokeColor=#334155;arcSize=5;" vertex="1" parent="1">
                    <mxGeometry x="40" y="1100" width="1840" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="legTitle" value="Legend" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=13;fontColor=#F8FAFC;fontStyle=1;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="60" y="1108" width="80" height="22" as="geometry"/>
                </mxCell>

                <mxCell id="leg1d" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#A855F7;strokeColor=none;" vertex="1" parent="1">
                    <mxGeometry x="60" y="1140" width="12" height="12" as="geometry"/>
                </mxCell>
                <mxCell id="leg1t" value="FL Server / Model Distribute" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="78" y="1136" width="200" height="18" as="geometry"/>
                </mxCell>

                <mxCell id="leg2d" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#6366F1;strokeColor=none;" vertex="1" parent="1">
                    <mxGeometry x="300" y="1140" width="12" height="12" as="geometry"/>
                </mxCell>
                <mxCell id="leg2t" value="Local Training" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="318" y="1136" width="100" height="18" as="geometry"/>
                </mxCell>

                <mxCell id="leg3d" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#EF4444;strokeColor=none;" vertex="1" parent="1">
                    <mxGeometry x="440" y="1140" width="12" height="12" as="geometry"/>
                </mxCell>
                <mxCell id="leg3t" value="CKKS Encryption / Decryption" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="458" y="1136" width="200" height="18" as="geometry"/>
                </mxCell>

                <mxCell id="leg4d" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#22C55E;strokeColor=none;" vertex="1" parent="1">
                    <mxGeometry x="680" y="1140" width="12" height="12" as="geometry"/>
                </mxCell>
                <mxCell id="leg4t" value="gRPC Communication" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="698" y="1136" width="140" height="18" as="geometry"/>
                </mxCell>

                <mxCell id="leg5d" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#F59E0B;strokeColor=none;" vertex="1" parent="1">
                    <mxGeometry x="860" y="1140" width="12" height="12" as="geometry"/>
                </mxCell>
                <mxCell id="leg5t" value="FedAvg Aggregation" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="878" y="1136" width="140" height="18" as="geometry"/>
                </mxCell>

                <mxCell id="leg6d" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#3B82F6;strokeColor=none;" vertex="1" parent="1">
                    <mxGeometry x="1040" y="1140" width="12" height="12" as="geometry"/>
                </mxCell>
                <mxCell id="leg6t" value="Metrics / Storage" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#94A3B8;fontFamily=Inter;" vertex="1" parent="1">
                    <mxGeometry x="1058" y="1136" width="120" height="18" as="geometry"/>
                </mxCell>

                <mxCell id="legSummary" value="Dataset: CIC-IDS2017 | Rounds: 25 | Clients: 3 (IID) | HE: CKKS (TenSEAL) | Aggregation: FedAvg | Model: CNN-LSTM" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#64748B;fontFamily=Inter;fontStyle=2;" vertex="1" parent="1">
                    <mxGeometry x="1200" y="1136" width="660" height="18" as="geometry"/>
                </mxCell>

            </root>
        </mxGraphModel>
    </diagram>
</mxfile>
